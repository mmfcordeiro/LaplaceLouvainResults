
<!DOCTYPE html>
<html>

  <head>
    <script src="src/svg-pan-zoom.js"></script>
    <script src="src/jquery.min.js"></script>
  </head>

  <body>
    <h1>Demo for svg-pan-zoom: Dynamic SVG load</h1>
    
    <div class="controls">
      <button id="swap">swap</button>
      <button id="zoom-in">Zoom in</button>
      <button id="zoom-out">Zoom out</button>
      <button id="reset">Reset</button>
    </div>
    <div id="container"></div>
    

    <script>
      // Don't use window.onLoad like this in production, because it can only listen to one function.
      $(function() {
        var lastEventListener = null;

        function createNewEmbed(src){
          var embed = document.createElement('embed');
          embed.setAttribute('style', 'width: 100%; height: 700px; border:1px solid black;');
          embed.setAttribute('type', 'image/svg+xml');
          embed.setAttribute('src', src);

          document.getElementById('container').appendChild(embed)

          lastEventListener = function(){
            svgPanZoom(embed, {
              zoomEnabled: true,
              controlIconsEnabled: false
            });
          }
          embed.addEventListener('load', lastEventListener)

          return embed
        }

        var lastEmbedSrc = 'svg/JureFull.svg'
          , lastEmbed = createNewEmbed(lastEmbedSrc)
          ;

        function removeEmbed(){
          // Destroy svgpanzoom
          svgPanZoom(lastEmbed).destroy()
          // Remove event listener
          lastEmbed.removeEventListener('load', lastEventListener)
          // Null last event listener
          lastEventListener = null
          // Remove embed element
          document.getElementById('container').removeChild(lastEmbed)
          // Null reference to embed
          lastEmbed = null
        }

        document.getElementById('zoom-in').addEventListener('click', function(ev){
          ev.preventDefault()

          panZoom.zoomIn()
        });

        document.getElementById('zoom-out').addEventListener('click', function(ev){
          ev.preventDefault()

          panZoom.zoomOut()
        });

        document.getElementById('reset').addEventListener('click', function(ev){
          ev.preventDefault()

          panZoom.resetZoom()
        });


        $('#swap').on('click', function(){
          // Remove last added svg
          removeEmbed()

          if (lastEmbedSrc == 'svg/JureFull.svg') {
            lastEmbedSrc = 'svg/JureCommunities.svg'
          } else {
            lastEmbedSrc = 'svg/JureFull.svg'
          }

          lastEmbed = createNewEmbed(lastEmbedSrc)
        })
      });
    </script>

  </body>

</html>
